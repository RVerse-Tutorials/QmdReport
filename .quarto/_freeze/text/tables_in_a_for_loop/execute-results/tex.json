{
  "hash": "a0f1fc60d271a00cee47393e91fd7356",
  "result": {
    "markdown": "---\nalways_allow_html: true\n---\n\n\n\n# Tables in a for loop\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n\nOutputting tables (or figure) in a for loop works fine in Quarto, but there is no way to set the table numbers dynamically and get all the cross-references working in Word, HTML and PDF. We really need that dynamic numbering and cross-reference feature in a big report. \n\n## Example of tables produced in a for loop\n\nLook at the Code (link at top in HTML output) to see the `cat(knitr::knit_print(tab))` trick for getting your tables to appear.\n\n\n\n\n\\begin{table}\n\n\\caption{\\label{tab:unnamed-chunk-2}We can set a caption but no way to cross-reference it}\n\\centering\n\\begin{tabular}[t]{lrrrr}\n\\toprule\n  & mpg & cyl & disp & hp\\\\\n\\midrule\nMazda RX4 & 21 & 6 & 160 & 110\\\\\nMazda RX4 Wag & 21 & 6 & 160 & 110\\\\\n\\bottomrule\n\\multicolumn{5}{l}{\\rule{0pt}{1em}\\textit{Note: }}\\\\\n\\multicolumn{5}{l}{\\rule{0pt}{1em}kable}\\\\\n\\end{tabular}\n\\end{table}\n\n\\begin{table}\n\n\\caption{\\label{tab:unnamed-chunk-2}We can set a caption but no way to cross-reference it}\n\\centering\n\\begin{tabular}[t]{lrrrr}\n\\toprule\n  & mpg & cyl & disp & hp\\\\\n\\midrule\nMazda RX4 & 21 & 6 & 160 & 110\\\\\nMazda RX4 Wag & 21 & 6 & 160 & 110\\\\\n\\bottomrule\n\\multicolumn{5}{l}{\\rule{0pt}{1em}\\textit{Note: }}\\\\\n\\multicolumn{5}{l}{\\rule{0pt}{1em}kable}\\\\\n\\end{tabular}\n\\end{table}\n\n\n\n\n## Getting the cross-reference links\n\nWe have to use a bit of magic to get our dynamic table numbers and links using Quarto's cross-referencing. The trick is to use a child Rmd (or qmd) in a for loop. This trick can be used for figures too but I'll just show it here with tables. This code inspired from [this gist](https://gist.github.com/rmoff/a043676a2f084b81a434).\n\nWe use `knit_expand()` and make a child Rmd that uses double curly braces like `{{value.to.match}}` in the code. That way the value at the time this Rmd was embedded can be referenced. Note that if `value.to.match` were a string (which it is not in this example), we would need to add quotes around `{{value.to.match}}` in our code.\n\nWith this approach we get our numbered tables and we can reference the tables usual such as @tbl-cyl8. Click on the Code link at top (HTML output) to see how it's done.\n\n\n\n\n\n\n\n\n---\nalways_allow_html: true\n---\n\n::: {.cell}\n\n:::\n<!-- unlike tbl-cap, label won't take a string so !expr tbl_label won't work. But you can still make this work with the hack below. -->\n\n::: {#tbl-cyl4 .cell tbl-cap='Cars with 4 cylinders. These tables have cross-ref links via @tbl-xyz.'}\n::: {.cell-output-display}\n\\begin{table}\n\\centering\n\\begin{tabular}[t]{lrrrr}\n\\toprule\n  & mpg & cyl & disp & hp\\\\\n\\midrule\nDatsun 710 & 22.8 & 4 & 108.0 & 93\\\\\nMerc 240D & 24.4 & 4 & 146.7 & 62\\\\\nMerc 230 & 22.8 & 4 & 140.8 & 95\\\\\n\\bottomrule\n\\multicolumn{5}{l}{\\rule{0pt}{1em}\\textit{Note: }}\\\\\n\\multicolumn{5}{l}{\\rule{0pt}{1em}kable}\\\\\n\\end{tabular}\n\\end{table}\n:::\n:::\n---\nalways_allow_html: true\n---\n\n::: {.cell}\n\n:::\n<!-- unlike tbl-cap, label won't take a string so !expr tbl_label won't work. But you can still make this work with the hack below. -->\n\n::: {#tbl-cyl8 .cell tbl-cap='Cars with 8 cylinders. These tables have cross-ref links via @tbl-xyz.'}\n::: {.cell-output-display}\n\\begin{table}\n\\centering\n\\begin{tabular}[t]{lrrrr}\n\\toprule\n  & mpg & cyl & disp & hp\\\\\n\\midrule\nHornet Sportabout & 18.7 & 8 & 360.0 & 175\\\\\nDuster 360 & 14.3 & 8 & 360.0 & 245\\\\\nMerc 450SE & 16.4 & 8 & 275.8 & 180\\\\\n\\bottomrule\n\\multicolumn{5}{l}{\\rule{0pt}{1em}\\textit{Note: }}\\\\\n\\multicolumn{5}{l}{\\rule{0pt}{1em}kable}\\\\\n\\end{tabular}\n\\end{table}\n:::\n:::\n\n\n\n\n```{=openxml}\n<w:p><w:r><w:br w:type=\"page\"/></w:r></w:p>\n```\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{\"knit_meta_id\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\"]}},\"value\":[{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"booktabs\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"longtable\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"array\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"multirow\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"wrapfig\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"float\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"colortbl\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"pdflscape\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"tabu\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"threeparttable\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"threeparttablex\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"ulem\"]},{\"type\":\"character\",\"attributes\":{},\"value\":[\"normalem\"]},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"makecell\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"xcolor\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]}]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}