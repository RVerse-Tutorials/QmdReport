{"title":"Kable vs Flex vs qt","markdown":{"yaml":{"always_allow_html":true},"headingText":"Kable vs Flex vs qt","headingAttr":{"id":"sec-kableflexgt","classes":[],"keyvalue":[]},"containsRefs":false,"markdown":"\n\n```{r warning=FALSE, echo=FALSE, message=FALSE}\nknitr::opts_chunk$set(echo = FALSE, warning=FALSE, message=FALSE)\nsource(here::here(\"tables\", \"_common.R\"))\n```\n\n\nHere I compare a three different ways to make tables.\n\n```{r}\ntbl_cap <- \"Donec bibendum pharetra arcu vitae porttitor. Morbi ac quam nunc. Ut cursus dolor a mauris aliquet vulputate. Morbi elementum ullamcorper augue, et tincidunt libero facilisis posuere. Nam congue velit non elit sollicitudin aliquet.\"\ndt <- (mtcars[1:10,])\nf1 <- \"Here is a footnote about this table\"\nf2 <- \"Here is a second footnote.\"\n```\n\n\n## `kable`\n\nHere is the {kable} table @tbl-kable. {kabel} is part of {knitr} so definitely going to be supported by Quarto since Quarto uses the {knitr} engine. Cross-referencing works across HTML, PDF and Word but output to Word is not always great.\n\n```{r}\n#| label: tbl-kable\n#| tbl-cap: !expr paste(\"kable:\", tbl_cap)\n#| echo: true\nlibrary(knitr)\nlibrary(kableExtra)\n# note hold_position not working in Quarto v1.0.38.\nkbl(dt, booktabs = TRUE) %>%\n  kable_styling(latex_options = c(\"scale_down\")) %>%\n  kableExtra::footnote(symbol = c(f1, f2))\n```\n\n### `kable` quirks\n\n* Make sure to put `always_allow_html: true` in the yaml at the top of your Rmd or qmd file if outputting to Word. I can't figure out how to put it in the `\n* Word output is often not good looking. This is a known issue with `kable`\n* Do not pass in caption to `kbl()` if you want to use Quarto's cross-reference engine.\n* `kbl(..., format=\"pandoc\")` can help for Word if your templates stop working but destroys the PDF output.\n\n## `flextable`\n\nHere is the {flextable} table @tbl-flex.  {flextable} gives you a lot more control over your tables with a grammar format (like ggplot2). It also gives nice output to Word, PDF and HTML. Sadly in Quarto v1.0.38 cross-reference and table captioning for Word and PDF is completely broken, but the developers know about this. The {officer} package, which I think Quarto is leaning on for Word generation, use {flextable} so I am hoping that {flextable} gets moved into the RStudio suite.\n\n```{r}\n#| label: tbl-flex\n#| tbl-cap: !expr paste(\"flextable:\", tbl_cap)\n#| echo: true\nlibrary(flextable)\ndt %>%\n  flextable() %>%\n  autofit() %>%\n  flextable::footnote(i = 1, j = 1:2,\n            value = as_paragraph(c(f1, f2)),\n            ref_symbols = c(\"a\", \"b\"),\n            part = \"header\") %>%\n  font(fontname=\"Times New Roman\", part=\"all\") %>%\n  fontsize(size=12)\n```\n\n### `flextable` quirks\n\n* Cross-refs broken in Word and PDF. Known issue.\n\n## `gt`\n\nHere is the {gt} table @tbl-gt. {gt} has many of the same features as {flextable} and is in the RStudio suite so maybe it'll get more Quarto support in the long run.\nBut like {kable}, the Word output is not so great, at least not by default. \n\n```{r}\n#| label: tbl-gt\n#| tbl-cap: !expr paste(\"gt:\", tbl_cap)\n#| echo: true\nlibrary(gt)\ndt %>%\n  gt() %>%\n  tab_source_note(source_note = f1) %>%\n  tab_source_note(source_note = f2) %>%\n  tab_options(\n      table.font.size = px(18), \n      table.font.names = \"Times New Roman\",\n      data_row.padding = px(1))\n```\n\n### `qt` quirks\n\n* Table captions broken in PDF. Known issue. The \"Table X.\" part is missing.\n* I couldn't get {gt} to respect my font request for HTML unlike for {flextable}\n\n\n```{=openxml}\n<w:p><w:r><w:br w:type=\"page\"/></w:r></w:p>\n```\n"},"formats":{"docx":{"execute":{"fig-width":5,"fig-height":4,"fig-format":"png","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":false,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"code-overflow":"wrap","engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"docx","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"page-width":6.5},"pandoc":{"default-image-extension":"png","to":"docx","toc":true,"reference-doc":"../template.docx","output-file":"kable_flex.docx"},"language":{},"metadata":{"bibliography":["../references.bib"],"always_allow_html":true},"extensions":{"book":{}}},"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":false,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"code-overflow":"wrap","engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":true,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"output-file":"kable_flex.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.0.38","bibliography":["../references.bib"],"theme":"cosmo","always_allow_html":true},"extensions":{"book":{"multiFile":true}}},"pdf":{"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":false,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"code-overflow":"wrap","engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","toc":true,"include-in-header":["../partials/inheader.tex"],"output-file":"kable_flex.pdf"},"language":{},"metadata":{"block-headings":true,"bibliography":["../references.bib"],"documentclass":"scrbook","classoption":["oneside"],"template-partials":["../partials/before-body.tex"],"lof":true,"lot":true,"always_allow_html":true},"extensions":{"book":{}}}}}