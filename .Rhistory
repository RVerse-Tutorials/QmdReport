install.packages("tinytex")
remove.packages("tinytex", lib="/Library/Frameworks/R.framework/Versions/4.1/Resources/library")
load("~/Documents/GitHub/QmdReport/data/salmon.RData")
salmon
unique(salmon$COMMON_POPULATION_NAME)
?xtable_to_flextable
if( require("xtable") ){
data(tli)
fm3 <- glm(disadvg ~ ethnicty*grade, data = tli, family = binomial)
ft <- flextable::xtable_to_flextable(xtable::xtable(anova(fm3)), hline.after = c(1))
ft <- ft %>%
font(fontname="Times New Roman", part="all") %>%
fontsize(size=12)
}
knitr::opts_chunk$set(echo = FALSE, warning=FALSE, message=FALSE)
library(knitr)
library(dplyr) # need this for %>% function
library(flextable)
library(xtable)
ishtml <- knitr::is_html_output()
ispdf <- knitr::is_latex_output()
isword <- !ishtml & !ispdf
if( require("xtable") ){
data(tli)
fm3 <- glm(disadvg ~ ethnicty*grade, data = tli, family = binomial)
ft <- flextable::xtable_to_flextable(xtable::xtable(anova(fm3)), hline.after = c(1))
ft <- ft %>%
font(fontname="Times New Roman", part="all") %>%
fontsize(size=12)
}
cat(knitr::knit_print(ft))
ft
cat(ft)
?knit_print
print(ft)
datafil <- here::here("data", "Lower_Columbia_River_Chinook.csv")
modtime <- system(paste("git log -1 --format=%cd", datafil), intern=TRUE)
counts <- read.csv(datafil, stringsAsFactors=FALSE)
ntbl <- length(unique(counts$`Common Population Name`))
tbl <- ntbl # how many to print
nYr <- 2000:2014
tbl
head(counts)
unique(counts$`Common Population Name`)
ntbl <- length(unique(counts$COMMON_POPULATION_NAME))
tbl <- ntbl # how many to print
nYr <- 2000:2014
tbl
source("~/Documents/GitHub/QmdReport/tables/_Table_Counts.R")
fil <- "Lower_Columbia_River_Chinook.csv"
filful <- here::here("data", fil)
modtime <- system(paste("git log -1 --format=%cd", filful), intern=TRUE)
counts <- read.csv(filful, stringsAsFactors=FALSE)
colnames(counts) <- fixcols(colnames(counts))
knitr::opts_chunk$set(echo = FALSE, warning=FALSE, message=FALSE)
library(gt)
library(tidyverse)
library(glue)
# readTableCounts defined in _Table_Counts.R
out <- readTableCounts("Lower_Columbia_River_Chinook.csv")
modtime <- out$modtime
counts <- out$counts
counts %>% select(c("Year", "Spawners"))
?regulartable
tab <- counts %>%
select(c("Year", "Spawners")) %>%
gt() %>%
tab_header(title = md("Comparison of per capita CO<sub>2</sub> emissions from domestic aviation (2018)")) %>%
#Add a data source footnote
tab_source_note(source_note = paste("** data file date:", modtime)) %>%
tab_source_note(source_note = "* These spawner counts are from river redd surveys.")
tab
tab <- counts %>%
select(c("Year", "Spawners")) %>%
gt() %>%
tab_header(title = md("Comparison of per capita CO<sub>2</sub> emissions from domestic aviation (2018)")) %>%
#Add a data source footnote
tab_source_note(source_note = paste("** data file date:", modtime)) %>%
tab_source_note(source_note = "* These spawner counts are from river redd surveys.") %>%
fmt_number(everything(), decimals = 2)
tab
# Create my table function; set default cols but different cols can be passed in
tablecount <- function(data, cols="Spawners", caption="", cap_wide=FALSE){
dat <- data %>%
select(c("Year", cols)) %>%
cap <- paste0(caption, "Yearly counts of ", paste(cols, collapse=" and "), " for ", min(dat$Year), " to ", max(dat$Year))
tab <- data %>%
select(c("Year", "Spawners")) %>%
gt() %>%
tab_header(title = md("Comparison of per capita CO<sub>2</sub> emissions from domestic aviation (2018)")) %>%
#Add a data source footnote
tab_source_note(source_note = paste("** data file date:", modtime)) %>%
tab_source_note(source_note = "* These spawner counts are from river redd surveys.") %>%
fmt_number(cols, decimals = 2) %>%
tab_options(table.font.names = "Times New Roman") %>%
tab_options(table.font.size = 12) %>%
tab_options(data_row.padding = px(1))
}
tbl <- 2
col <- c("Spawners", "Fracwild")
for(i in unique(counts$`Common Population Name`)[1:tbl]){
dat <- subset(counts, `Common Population Name`==i & Year %in% 2000:2014)
cap <- paste0("Table ", tbl, ". ", i, ". ")
tab <- tablecount(dat, cols=col, caption=cap)
cat("\n", wordnewpage, "\n")
cat(knitr::knit_print(tab))
tbl <- tbl + 1
}
dat
cols <- c("Spawners", "Fracwild")
dat %>%
select(c("Year", cols))
tablecount(counts, cols=cols)
# Create my table function; set default cols but different cols can be passed in
tablecount <- function(data, cols="Spawners", caption="", cap_wide=FALSE){
cap <- paste0(caption, "Yearly counts of ", paste(cols, collapse=" and "), " for ", min(dat$Year), " to ", max(dat$Year))
tab <- data %>%
select(c("Year", "Spawners")) %>%
gt() %>%
tab_header(title = md("Comparison of per capita CO<sub>2</sub> emissions from domestic aviation (2018)")) %>%
#Add a data source footnote
tab_source_note(source_note = paste("** data file date:", modtime)) %>%
tab_source_note(source_note = "* These spawner counts are from river redd surveys.") %>%
fmt_number(cols, decimals = 2) %>%
tab_options(table.font.names = "Times New Roman") %>%
tab_options(table.font.size = 12) %>%
tab_options(data_row.padding = px(1))
}
tbl <- 2
col <- c("Spawners", "Fracwild")
for(i in unique(counts$`Common Population Name`)[1:tbl]){
dat <- subset(counts, `Common Population Name`==i & Year %in% 2000:2014)
cap <- paste0("Table ", tbl, ". ", i, ". ")
tab <- tablecount(dat, cols=col, caption=cap)
cat("\n", wordnewpage, "\n")
cat(knitr::knit_print(tab))
tbl <- tbl + 1
}
head(counts)
# Create my table function; set default cols but different cols can be passed in
tablecount <- function(data, cols="Spawners", caption="", cap_wide=FALSE){
cap <- paste0(caption, "Yearly counts of ", paste(cols, collapse=" and "), " for ", min(dat$Year), " to ", max(dat$Year))
tab <- data %>%
select(c("Year", cols)) %>%
gt() %>%
tab_header(title = md("Comparison of per capita CO<sub>2</sub> emissions from domestic aviation (2018)")) %>%
#Add a data source footnote
tab_source_note(source_note = paste("** data file date:", modtime)) %>%
tab_source_note(source_note = "* These spawner counts are from river redd surveys.") %>%
fmt_number(cols, decimals = 2) %>%
tab_options(table.font.names = "Times New Roman") %>%
tab_options(table.font.size = 12) %>%
tab_options(data_row.padding = px(1))
}
tbl <- 2
col <- c("Spawners", "Fracwild")
for(i in unique(counts$`Common Population Name`)[1:tbl]){
dat <- subset(counts, `Common Population Name`==i & Year %in% 2000:2014)
cap <- paste0("Table ", tbl, ". ", i, ". ")
tab <- tablecount(dat, cols=col, caption=cap)
cat("\n", wordnewpage, "\n")
cat(knitr::knit_print(tab))
tbl <- tbl + 1
}
?google_font
default_fonts()
exibble %>%
dplyr::select(char, time) %>%
gt()
exibble %>%
dplyr::select(char, time) %>%
gt() %>% tab_options(
table.font.size = px(18),
data_row.padding = px(1))
exibble %>%
dplyr::select(char, time) %>%
gt() %>% tab_options(
table.font.size = px(18),
data_row.padding = px(1),)
exibble %>%
dplyr::select(char, time) %>%
gt() %>% tab_options(
table.font.size = px(18),
data_row.padding = px(1), table.font.names = c("Times")
)
google_font(name = "Merriweather")
exibble %>%
dplyr::select(char, time) %>%
gt() %>% tab_options(
table.font.size = px(18),
data_row.padding = px(1), table.font.names = "Times New Roman")
# Create my table function; set default cols but different cols can be passed in
tablecount <- function(data, cols="Spawners", caption="", cap_wide=FALSE){
cap <- paste0(caption, "Yearly counts of ", paste(cols, collapse=" and "), " for ", min(dat$Year), " to ", max(dat$Year))
tab <- data %>%
select(c("Year", cols)) %>%
gt() %>%
tab_header(title = md("Comparison of per capita CO<sub>2</sub> emissions from domestic aviation (2018)")) %>%
#Add a data source footnote
tab_source_note(source_note = paste("** data file date:", modtime)) %>%
tab_source_note(source_note = "* These spawner counts are from river redd surveys.") %>%
fmt_number(cols, decimals = 2) %>%
tab_options(
table.font.size = px(18),
table.font.names = "Times New Roman",
data_row.padding = px(1))
}
cols
tab <- tablecount(counts, cols=cols)
print(tab)
cat(tab)
tab
knit_print(tab)
knitr_print(tab)
knitr::knit_print(tab)
?flextable
mtcars
looplist <- mtcars %>% distinct(cyl) %>% select(cyl)
looplist
tbl_label <- paste0("tbl-cyl", {{value.to.match}})
paste0("tlb-", "tab", 1)
#| echo: true
tab_cap <- paste("This is a dynamically created caption. The length of mtcars is", nrow(mtcars), "rows")
tab_label <- paste0("tlb-", "tab", 10)
!expr tab_label
tab_label
paste0("tbl-", "tab", 10)
eval("a")
get("a")
a="B"
get(a)
?expr
expr("a")
class(expr("a"))
expr(function(){return("tbl-mtcars32"))
expr(function(){return("tbl-mtcars32")})
parse("A")
?eval
eval(expr("a"))
?knit.expand
?knit_expand
if (interactive()) browseVignettes(package = "knitr")
head(counts)
cvsfile <- "Lower_Columbia_River_Chinook.csv"
datafil <- here::here("data", cvsfile)
counts <- read.csv(datafil, stringsAsFactors=FALSE)
head(counts)
counts %>% distinct(COMMON_POPULATION_NAME)
counts %>% distinct(COMMON_POPULATION_NAME) %>% length()
counts %>% distinct(COMMON_POPULATION_NAME) %>% count()
class(counts %>% distinct(COMMON_POPULATION_NAME) %>% count())
class(counts %>% distinct(COMMON_POPULATION_NAME) %>% nrow()
)
counts %>% distinct(COMMON_POPULATION_NAME) %>% nrow()
modtime
