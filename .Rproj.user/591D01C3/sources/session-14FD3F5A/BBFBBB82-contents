---
title: "Table of Population Counts with qt"
---

For some reason I can't get Quarto to respect my font specification with {qt}.

```{r include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning=FALSE, message=FALSE)
library(gt)
library(tidyverse)
library(glue)
source(here::here("tables", "_Table_Counts.R"))
```

```{r}
# readTableCounts defined in _Table_Counts.R
out <- readTableCounts("Lower_Columbia_River_Chinook.csv")
modtime <- out$modtime
counts <- out$counts
```

```{r}
# Create my table function; set default cols but different cols can be passed in
tablecount <- function(data, cols="Spawners"){
  tab <- data %>%
    select(c("Year", cols)) %>%
    gt() %>%
   #Add a data source footnote
    tab_source_note(source_note = paste("** data file date:", modtime)) %>%
    tab_source_note(source_note = "* These spawner counts are from river redd surveys.") %>%
    fmt_number(cols, decimals = 2) %>%
    tab_options(
      table.font.size = px(18), 
      table.font.names = "Times New Roman",
      data_row.padding = px(1))
  }
```

```{r}
tbl <- 1
i <- unique(counts$`Common Population Name`)[tbl]
col <- c("Spawners", "Fracwild")
dat <- subset(counts, `Common Population Name`==i & Year %in% 2000:2003)
tbl_cap <- paste0("qt: ", i, " Yearly counts of ", paste(col, collapse=" and "), " for ", min(dat$Year), " to ", max(dat$Year))
```

```{r results='asis'}
#| label: tbl-countsqt
#| tbl-cap: !expr tbl_cap
  dat <- subset(counts, `Common Population Name`==i & Year %in% 2000:2014)
  tab <- tablecount(dat, cols=col)
  tab
  #cat("\n", wordnewpage, "\n")
  #cat(knitr::knit_print(tab))
  # print(tab) also works
```